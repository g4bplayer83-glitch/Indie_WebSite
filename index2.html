<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Indie_WebsiteV2</title>
  <link rel="icon" type="image/x-icon" href="icon.ico">
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #0b0b0b;
      color: #00ffff;
      font-family: Arial, sans-serif;
      overflow-x: hidden;
      text-align: center;
      scroll-behavior: smooth;
    }

    h1, h2, h3 {
      text-shadow: 0 0 20px #00ffff;
    }

    /* Style pour le titre avec effet d√©crypt√© */
    #mainTitle {
      cursor: pointer;
      transition: all 0.3s;
    }

    #mainTitle:hover {
      transform: scale(1.05);
    }

    /* Conteneur pour le texte anim√© */
    .moving-text-container {
      width: 100%;
      overflow: hidden;
      position: relative;
      height: 40px;
      display: flex;
      align-items: center;
    }

    /* Texte anim√© - appara√Æt √† droite, sort √† gauche */
    .moving-text {
      display: inline-block;
      white-space: nowrap;
      position: absolute;
      animation: scrollText 15s linear infinite;
    }

    @keyframes scrollText {
      0% { 
        left: 100%;
      }
      100% { 
        left: -100%;
      }
    }

    p {
      color: #ccfaff;
      line-height: 1.6em;
      max-width: 800px;
      margin: 10px auto;
    }

    a {
      color: #00ffff;
      text-decoration: none;
      border-bottom: 1px dotted #00ffff;
      transition: 0.3s;
      cursor: pointer;
    }

    a:hover {
      color: #000;
      background: #00ffff;
      padding: 2px 6px;
      border-radius: 6px;
    }

    /* √âcran de d√©marrage */
    #startScreen {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle, #001f2f, #000);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 20;
      animation: fadeIn 1s ease;
    }

    #startScreen button {
      padding: 14px 32px;
      background: transparent;
      border: 2px solid #00ffff;
      color: #00ffff;
      font-size: 1.2em;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
    }

    #startScreen button:hover {
      background: #00ffff;
      color: #000;
      box-shadow: 0 0 20px #00ffff;
      transform: scale(1.1);
    }

    /* √âcran de chargement */
    #loading {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle, #002f3f, #000);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      z-index: 10;
      transition: opacity 0.8s ease;
    }

    #loading.active {
      opacity: 1;
      visibility: visible;
    }

    .orb {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background-color: #00ffff;
      box-shadow: 0 0 25px #00ffff;
      animation: spinPulse 2s infinite ease-in-out;
    }

    @keyframes spinPulse {
      0% { transform: scale(1) rotate(0deg); opacity: 0.8; }
      50% { transform: scale(1.3) rotate(180deg); opacity: 1; }
      100% { transform: scale(1) rotate(360deg); opacity: 0.8; }
    }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }
    @keyframes fadeInMain { to { opacity: 1; } }

    main {
      opacity: 0;
      animation: fadeInMain 1s ease 9s forwards;
      padding: 30px;
      padding-bottom: 120px;
    }

    /* Contr√¥leur audio */
    #soundController {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(0, 20, 25, 0.8);
      border: 2px solid #00ffff;
      border-radius: 12px;
      box-shadow: 0 0 15px #00ffff;
      padding: 12px 16px;
      color: #00ffff;
      font-size: 0.9em;
      z-index: 5;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    #soundController input[type=range] {
      width: 100px;
      accent-color: #00ffff;
    }

    img {
      border: 2px solid #00ffff;
      border-radius: 10px;
      margin: 15px;
      width: 300px;
      transition: transform 0.4s ease, box-shadow 0.4s ease;
    }

    img:hover {
      transform: scale(1.05);
      box-shadow: 0 0 30px #00ffff;
    }

    note {
      display: block;
      background: rgba(0, 255, 255, 0.1);
      border-left: 4px solid #00ffff;
      margin: 20px auto;
      max-width: 600px;
      padding: 10px 15px;
      font-style: italic;
      color: #aef6f6;
    }
    
    #tetrisButton {
      color: #00ffff;
      cursor: pointer;
      transition: all 0.2s;
      text-shadow: 0 0 5px #00ffff;
      font-weight: bold;
      font-style: normal;
    }
    
    #tetrisButton:hover {
      color: #fff;
      text-shadow: 0 0 15px #00ffff, 0 0 25px #00ffff;
      transform: scale(1.2);
      display: inline-block;
    }

    /* Modal Tetris */
    #tetrisModal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.95);
      z-index: 100;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.3s ease;
    }

    #tetrisModal.active {
      display: flex;
    }

    #tetrisContainer {
      position: relative;
      background: rgba(0, 20, 25, 0.9);
      border: 3px solid #00ffff;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 0 40px #00ffff;
    }

    #closeButton {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: 2px solid #00ffff;
      color: #00ffff;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.2em;
      transition: all 0.3s;
    }

    #closeButton:hover {
      background: #00ffff;
      color: #000;
      transform: rotate(90deg);
    }

    #tetrisCanvas {
      border: 2px solid #00ffff;
      background: #000;
      display: block;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
    }

    #tetrisInfo {
      color: #00ffff;
      text-align: center;
      margin-top: 15px;
      font-size: 1.1em;
    }

    #tetrisScore {
      margin-top: 10px;
      font-size: 1.3em;
      text-shadow: 0 0 10px #00ffff;
    }
  </style>
</head>

<body>

  <!-- √âcran de d√©marrage -->
  <div id="startScreen">
    <h1>Indie_WebsiteV2</h1>
    <p style="color:#00ffff;margin-bottom:20px;">Appuyez pour commencer</p>
    <button id="startButton">‚ñ∂ Commencer</button>
  </div>

  <!-- √âcran de chargement -->
  <div id="loading">
    <div class="orb"></div>
    <p style="color:#00ffff;margin-top:20px;font-size:1.2em;">Chargement...</p>
  </div>

  <!-- Musiques -->
  <audio id="introMusic" src="intro.wav"></audio>
  <audio id="bgMusic" src="music.wav" loop></audio>

  <!-- Effets -->
  <audio id="hoverSound" src="hover.wav"></audio>
  <audio id="clickSound" src="click.wav"></audio>

  <!-- Contenu principal -->
  <main>
    <h1 id="mainTitle">Bienvenue sur Indie_WebsiteV2</h1>
    <div class="moving-text-container">
      <h2 class="moving-text">Projet exp√©rimental ‚Äì Page HTML interactive</h2>
    </div>

    <p>
      Ce site explore les sons, les effets visuels et les animations synchronis√©es en HTML, CSS.
      Il offre une exp√©rience immersive avec musique, vid√©o et interactions.
    </p>

    <note>üí° Astuce : quand vous lisez la vid√©o, la musique se coupe avec un fondu automatiquement, puis reprend ensuite.</note>

    <h3>Vid√©o en vedette</h3>
    <video id="myVideo" width="480" height="270" controls>
      <source src="ULTRAKILL Montage - TEOAT.mp4" type="video/mp4">
      Votre navigateur ne supporte pas la vid√©o.
    </video>

    <h3>Quelques liens utiles</h3>
    <p>
      üîó <a id="scrollToImages" title="Descendre √† la section des images">Voir les images plus bas</a><br>
      üåê <a href="https://www.mozilla.org" target="_blank" title="Visitez Mozilla dans une nouvelle fen√™tre">Visitez Mozilla</a>
    </p>

    <h3 id="images-section">Galerie d'images</h3>
    <p>Survolez les images pour voir un effet lumineux :</p>

    <img src="https://upload.wikimedia.org/wikipedia/commons/3/3a/Cat03.jpg" alt="Un chat mignon" title="Ceci est un chat üê±">
    <img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Example.jpg" alt="Exemple d'image" title="Image d'exemple">

    <note>üìù Remarque : ce site est encore en d√©veloppement. Cer<span id="tetrisButton" title="Jouer √† Tetris">t</span>aines fonctions peuvent √©voluer.</note>
  </main>

  <!-- Modal Tetris -->
  <div id="tetrisModal">
    <div id="tetrisContainer">
      <button id="closeButton">√ó</button>
      <canvas id="tetrisCanvas" width="200" height="360"></canvas>
      <div id="tetrisInfo">
        <div>Fl√®ches : D√©placer | ‚Üë : Rotation | Espace : Chute rapide</div>
        <div id="tetrisScore">Score: 0</div>
      </div>
    </div>
  </div>

  <!-- Contr√¥leur audio -->
  <div id="soundController">
    <button id="toggleMusic">‚è∏ Pause musique</button>
    <input type="range" id="volumeSlider" min="0" max="1" step="0.05" value="0.5">
    <div id="clock">--:--:--</div>
  </div>

  <!-- Import des scripts d'effets -->
  <script src="decryptedText.js"></script>
  <script src="gradualBlur.js"></script>
  <script src="clickSpark.js"></script>

  <script>
    const startButton = document.getElementById("startButton");
    const startScreen = document.getElementById("startScreen");
    const loading = document.getElementById("loading");
    const introMusic = document.getElementById("introMusic");
    const bgMusic = document.getElementById("bgMusic");
    const hoverSound = document.getElementById("hoverSound");
    const clickSound = document.getElementById("clickSound");
    const vid = document.getElementById("myVideo");
    const toggleMusic = document.getElementById("toggleMusic");
    const volumeSlider = document.getElementById("volumeSlider");
    const clock = document.getElementById("clock");
    let isFading = false;

    // D√©marrage
    startButton.addEventListener("click", () => {
      playClick();
      startScreen.style.animation = "fadeOut 0.8s forwards";
      setTimeout(() => {
        loading.classList.add("active");
        introMusic.volume = 0.6;
        bgMusic.volume = 0.5;
        introMusic.play();
        setTimeout(() => {
          introMusic.pause();
          loading.classList.remove("active");
          bgMusic.play();
        }, 8000);
      }, 500);
    });

    // Fade musique vid√©o
    function fadeOutAudio(audio, duration = 500) {
      if (isFading) return;
      isFading = true;
      const step = audio.volume / (duration / 50);
      const fade = setInterval(() => {
        if (audio.volume > 0.05) audio.volume -= step;
        else {
          audio.volume = 0;
          audio.pause();
          clearInterval(fade);
          isFading = false;
        }
      }, 50);
    }

    function fadeInAudio(audio, targetVol = 0.5, duration = 1000) {
      if (isFading) return;
      isFading = true;
      audio.play();
      let vol = 0;
      audio.volume = 0;
      const step = targetVol / (duration / 50);
      const fade = setInterval(() => {
        if (vol < targetVol) {
          vol += step;
          audio.volume = vol;
        } else {
          audio.volume = targetVol;
          clearInterval(fade);
          isFading = false;
        }
      }, 50);
    }

    vid.addEventListener("play", () => fadeOutAudio(bgMusic, 1200));
    vid.addEventListener("pause", () => fadeInAudio(bgMusic, parseFloat(volumeSlider.value), 1200));
    vid.addEventListener("ended", () => fadeInAudio(bgMusic, parseFloat(volumeSlider.value), 1200));

    // Liens interactifs
    document.getElementById("scrollToImages").addEventListener("click", () => {
      document.getElementById("images-section").scrollIntoView({ behavior: "smooth" });
      playClick();
    });

    document.querySelectorAll("button").forEach(btn => {
      btn.addEventListener("mouseenter", () => {
        hoverSound.currentTime = 0;
        hoverSound.play();
      });
    });

    function playClick() {
      clickSound.currentTime = 0;
      clickSound.play();
    }

    // Musique / volume
    toggleMusic.addEventListener("click", () => {
      if (bgMusic.paused) {
        fadeInAudio(bgMusic, parseFloat(volumeSlider.value), 800);
        toggleMusic.textContent = "‚è∏ Pause musique";
      } else {
        fadeOutAudio(bgMusic, 800);
        toggleMusic.textContent = "‚ñ∂ Reprendre musique";
      }
      playClick();
    });

    volumeSlider.addEventListener("input", () => {
      const vol = parseFloat(volumeSlider.value);
      bgMusic.volume = vol;
      introMusic.volume = vol;
    });

    // Horloge
    setInterval(() => clock.textContent = new Date().toLocaleTimeString(), 1000);

    // === TETRIS ===
    const tetrisButton = document.getElementById("tetrisButton");
    const tetrisModal = document.getElementById("tetrisModal");
    const closeButton = document.getElementById("closeButton");
    const canvas = document.getElementById("tetrisCanvas");
    const ctx = canvas.getContext("2d");
    const scoreDisplay = document.getElementById("tetrisScore");

    const ROWS = 18;
    const COLS = 10;
    const BLOCK_SIZE = 20;
    let board = [];
    let score = 0;
    let gameActive = false;
    let currentPiece = null;
    let gameLoop = null;

    const SHAPES = [
      [[1,1,1,1]], // I
      [[1,1],[1,1]], // O
      [[0,1,0],[1,1,1]], // T
      [[1,0,0],[1,1,1]], // L
      [[0,0,1],[1,1,1]], // J
      [[0,1,1],[1,1,0]], // S
      [[1,1,0],[0,1,1]]  // Z
    ];

    const COLORS = ['#00ffff', '#ffff00', '#ff00ff', '#00ff00', '#ff8800', '#ff0000', '#0088ff'];

    function initBoard() {
      board = Array(ROWS).fill().map(() => Array(COLS).fill(0));
      score = 0;
      scoreDisplay.textContent = `Score: ${score}`;
    }

    function drawBoard() {
      ctx.fillStyle = '#000';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      for (let r = 0; r < ROWS; r++) {
        for (let c = 0; c < COLS; c++) {
          if (board[r][c]) {
            ctx.fillStyle = COLORS[board[r][c] - 1];
            ctx.fillRect(c * BLOCK_SIZE, r * BLOCK_SIZE, BLOCK_SIZE - 1, BLOCK_SIZE - 1);
            ctx.strokeStyle = '#00ffff';
            ctx.lineWidth = 1;
            ctx.strokeRect(c * BLOCK_SIZE, r * BLOCK_SIZE, BLOCK_SIZE - 1, BLOCK_SIZE - 1);
          }
        }
      }

      if (currentPiece) {
        ctx.fillStyle = COLORS[currentPiece.color];
        currentPiece.shape.forEach((row, r) => {
          row.forEach((cell, c) => {
            if (cell) {
              const x = (currentPiece.x + c) * BLOCK_SIZE;
              const y = (currentPiece.y + r) * BLOCK_SIZE;
              ctx.fillRect(x, y, BLOCK_SIZE - 1, BLOCK_SIZE - 1);
              ctx.strokeStyle = '#00ffff';
              ctx.strokeRect(x, y, BLOCK_SIZE - 1, BLOCK_SIZE - 1);
            }
          });
        });
      }
    }

    function createPiece() {
      const shapeIndex = Math.floor(Math.random() * SHAPES.length);
      return {
        shape: SHAPES[shapeIndex],
        color: shapeIndex,
        x: Math.floor(COLS / 2) - 1,
        y: 0
      };
    }

    function collides(piece, offsetX = 0, offsetY = 0) {
      for (let r = 0; r < piece.shape.length; r++) {
        for (let c = 0; c < piece.shape[r].length; c++) {
          if (piece.shape[r][c]) {
            const newX = piece.x + c + offsetX;
            const newY = piece.y + r + offsetY;
            if (newX < 0 || newX >= COLS || newY >= ROWS) return true;
            if (newY >= 0 && board[newY][newX]) return true;
          }
        }
      }
      return false;
    }

    function mergePiece() {
      currentPiece.shape.forEach((row, r) => {
        row.forEach((cell, c) => {
          if (cell) {
            const y = currentPiece.y + r;
            const x = currentPiece.x + c;
            if (y >= 0) board[y][x] = currentPiece.color + 1;
          }
        });
      });
    }

    function clearLines() {
      let linesCleared = 0;
      for (let r = ROWS - 1; r >= 0; r--) {
        if (board[r].every(cell => cell !== 0)) {
          board.splice(r, 1);
          board.unshift(Array(COLS).fill(0));
          linesCleared++;
          r++;
        }
      }
      if (linesCleared > 0) {
        score += linesCleared * 100;
        scoreDisplay.textContent = `Score: ${score}`;
      }
    }

    function rotatePiece() {
      const rotated = currentPiece.shape[0].map((_, i) =>
        currentPiece.shape.map(row => row[i]).reverse()
      );
      const oldShape = currentPiece.shape;
      currentPiece.shape = rotated;
      if (collides(currentPiece)) {
        currentPiece.shape = oldShape;
      }
    }

    function gameStep() {
      if (!collides(currentPiece, 0, 1)) {
        currentPiece.y++;
      } else {
        mergePiece();
        clearLines();
        currentPiece = createPiece();
        if (collides(currentPiece)) {
          gameActive = false;
          clearInterval(gameLoop);
          alert(`Game Over! Score: ${score}`);
          tetrisModal.classList.remove("active");
        }
      }
      drawBoard();
    }

    function startGame() {
      initBoard();
      currentPiece = createPiece();
      gameActive = true;
      drawBoard();
      gameLoop = setInterval(gameStep, 500);
    }

    tetrisButton.addEventListener("click", () => {
      playClick();
      tetrisModal.classList.add("active");
      startGame();
    });

    closeButton.addEventListener("click", () => {
      playClick();
      tetrisModal.classList.remove("active");
      gameActive = false;
      if (gameLoop) clearInterval(gameLoop);
    });

    document.addEventListener("keydown", (e) => {
      if (!gameActive) return;
      
      // Emp√™cher le scroll de la page avec les fl√®ches
      if (["ArrowLeft", "ArrowRight", "ArrowDown", "ArrowUp", " "].includes(e.key)) {
        e.preventDefault();
      }
      
      if (e.key === "ArrowLeft" && !collides(currentPiece, -1, 0)) {
        currentPiece.x--;
      } else if (e.key === "ArrowRight" && !collides(currentPiece, 1, 0)) {
        currentPiece.x++;
      } else if (e.key === "ArrowDown" && !collides(currentPiece, 0, 1)) {
        currentPiece.y++;
      } else if (e.key === "ArrowUp") {
        rotatePiece();
      } else if (e.key === " ") {
        while (!collides(currentPiece, 0, 1)) {
          currentPiece.y++;
        }
      }
      drawBoard();
    });

    tetrisModal.addEventListener("click", (e) => {
      if (e.target === tetrisModal) {
        tetrisModal.classList.remove("active");
        gameActive = false;
        if (gameLoop) clearInterval(gameLoop);
      }
    });

    // ===== INITIALISATION DES EFFETS =====
    
    // 1. Effet de texte d√©crypt√© sur le titre
    const titleElement = document.getElementById('mainTitle');
    const decryptedTitle = new DecryptedText(titleElement, {
      speed: 30,
      maxIterations: 15,
      animateOn: 'hover',
      sequential: true,
      revealDirection: 'start'
    });

    // 2. Effet de blur graduel en bas de page
    const pageBlur = new GradualBlur({
      position: 'bottom',
      strength: 3,
      height: '8rem',
      divCount: 6,
      exponential: true,
      opacity: 0.9,
      curve: 'ease-out',
      target: 'page'
    });

    // 3. Effet de particules au clic sur tout le body
    const bodySparkEffect = new ClickSpark(document.body, {
      sparkColor: '#00ffff',
      sparkSize: 15,
      sparkRadius: 20,
      sparkCount: 12,
      duration: 500,
      easing: 'ease-out',
      extraScale: 1.2
    });

    console.log('‚ú® Tous les effets sont charg√©s !');
  </script>
  
</body>
</html>
